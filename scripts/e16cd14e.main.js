function masonryInit(){$container.masonry().masonry("destroy").imagesLoaded().always(function(){$container.masonry({itemSelector:".card",isAnimated:!0})})}function request(){if($container.empty(),isNaN(counter)&&(counter=0),24===counter?$older.addClass("disabled"):$older.removeClass("disabled"),shoeMode)a="q=title:WshoeAYWT";else var a="q=selftext:WAYWT = What Are You Wearing Today";$.getJSON("http://www.reddit.com/r/malefashionadvice/search.json?"+a+"&syntax=lucene&restrict_sr=true&sort=new",function(a){var b=a.data.children[counter].data,c=$("#thread-title");c.html(b.title),shoeMode?history.pushState("","","#"+counter+"/shoemode/"+b.title.toLowerCase().slice(9).replace(/\s/g,"").replace(".","-")):history.pushState("","","#"+counter+"/"+b.title.toLowerCase().slice(7).replace(/\s/g,"").replace(".","-")),$.getJSON(b.url+".json?jsonp=?&sort=top",function(a){function c(a,b){return-1!==a.toLowerCase().indexOf(b,a.length-b.length)}for(var d=a[1].data.children,e=[],f=0;f<d.length-1;f++){var g=d[f].data.body_html.match(/a href="([^"]*)/);if(g){var h=g[1];e.push(h.toLowerCase().indexOf("imgur.com")>=0&&h.toLowerCase().indexOf("imgur.com/a/")<=0&&h.toLowerCase().indexOf("imgur.com/gallery")<=0&&h.toLowerCase().indexOf(",")<=0&&c(h,".jpg")===!0||c(h,".png")===!0||c(h,".gif")===!0&&c(h,"l.jpg")===!1&&c(h,"l.png")===!1&&c(h,"l.gif")===!1?h.replace(".jpg","l.jpg"):h.toLowerCase().indexOf("imgur.com")>=0&&h.toLowerCase().indexOf("imgur.com/a/")<=0&&h.toLowerCase().indexOf("imgur.com/gallery")<=0&&h.toLowerCase().indexOf(",")<=0&&c(h,".jpg")===!1&&c(h,".png")===!1&&c(h,".gif")===!1?h+="l.jpg":h)}}for(var f=0;f<e.length;f++){var i;i=e[f].toLowerCase().indexOf("imgur.com")>=0?e[f].replace("l.jpg",".jpg"):e[f];var j='<div class="card"><a href="'+i+'" class="img-link fancybox" rel="group"><img src='+e[f]+'></a><div class="card-info"><a class="author" href="//reddit.com/user/'+d[f].data.author+'" target="_blank">'+d[f].data.author+'</a><span class="score icon-resize-vertical">'+d[f].data.score+'</span><a class="reddit-link icon-reddit" href=//reddit.com'+b.permalink+d[f].data.id+' target="_blank"></a></div></div>';$container.append(j).masonry().masonry("destroy").imagesLoaded().always(function(){$container.masonry().masonry("reloadItems")})}$("img").error(function(){var a='<a class="view-on" target="_blank" href='+$(this).attr("src").replace("l.jpg",".jpg")+"><p><span>thumbnail unavailable</span>";$(this).attr("src").indexOf("drsd.so")>-1||$(this).attr("src").indexOf("dressed.so")>-1?$(this).unbind("error").closest(".img-link").replaceWith(a+"<span>view on dressed.so</span></p></a>"):$(this).attr("src").indexOf("imgur.com")>-1?$(this).unbind("error").closest(".img-link").replaceWith(a+"<span>view on imgur</span></p></a>"):$(this).attr("src").indexOf("reddit.com")>-1?$(this).unbind("error").closest(".card").remove():$(this).unbind("error").closest(".img-link").replaceWith(a+"<span>view here</span></p></a>"),masonryInit()})})})}var counter=parseInt(window.location.hash.slice(1)),$newer=$("#newer"),$older=$("#older"),$newest=$("#newest"),$shoeMode=$("#shoe-mode"),$container=$("#images");$newer.on("click",function(a){a.preventDefault(),0!==counter&&(counter-=1,request())}),$older.on("click",function(a){a.preventDefault(),counter+=1,request()}),$newest.on("click",function(a){a.preventDefault(),0!==counter&&(counter=0,request())});var shoeMode=!1;$shoeMode.on("click",function(){shoeMode=shoeMode?!1:!0,request(),counter=0}),window.location.hash.indexOf("shoemode")>-1?(shoeMode=!0,$shoeMode.attr("checked",!0)):shoeMode=!1,request(),masonryInit(),$.ajaxSetup({beforeSend:function(){$("#loading").addClass("show")},complete:function(){$container.imagesLoaded().always(function(){$("#loading").removeClass("show")})}}),$(".fancybox").attr("rel","gallery").fancybox({helpers:{overlay:{css:{background:"rgba(0,0,0,0.8)"}}},padding:0});var $nav=$("nav"),offset=$nav.offset().top;$(window).on("scroll",function(){$(this).scrollTop()>offset?($nav.addClass("sticky"),$("h1").css({"margin-bottom":$nav.outerHeight()})):($nav.removeClass("sticky"),$("h1").css({"margin-bottom":0}))});